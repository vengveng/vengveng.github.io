<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Spotify Callback</title>
</head>
<body>
  <div id="msg" style="font:14px -apple-system,system-ui,Segoe UI,Roboto,sans-serif;padding:16px">
    Ready. Awaiting OAuth redirectâ€¦
  </div>
  <script>
    (function () {
      const p = new URL(location.href).searchParams;
      const code  = p.get("code");
      const error = p.get("error");
      const el = document.getElementById("msg");
      try {
        if (window.opener && (code || error)) {
          window.opener.postMessage({ type: "SPOTIFY_AUTH_CODE", code, error }, "*");
          el.textContent = code ? "Authorization complete. You can close this window."
                                : "Error: " + error;
        } else {
          el.textContent = code ? "Authorization complete (no opener)."
                                : "No OAuth parameters found. This page is meant to be opened by Spotify during login.";
        }
      } catch (e) {
        el.textContent = "Callback error: " + e;
      }
    })();
  </script>
</body>
</html>